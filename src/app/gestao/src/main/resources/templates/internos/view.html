<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalhe Funcionário Interno</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="p-4">

<h2>Detalhe Funcionário Interno</h2>

<!-- Dados do Funcionário Interno -->
<dl class="row">
    <dt class="col-sm-3">Matrícula</dt>
    <dd class="col-sm-9" th:text="${interno.funcionario.matricula}"></dd>

    <dt class="col-sm-3">Nome</dt>
    <dd class="col-sm-9" th:text="${interno.funcionario.nome}"></dd>

    <dt class="col-sm-3">CPF</dt>
    <dd class="col-sm-9" th:text="${interno.funcionario.cpf}"></dd>

    <dt class="col-sm-3">Data Nascimento</dt>
    <dd class="col-sm-9" th:text="${interno.dataNascimento}"></dd>
</dl>

<hr>

<!-- Lista de Projetos Vinculados -->
<h4>Projetos Vinculados</h4>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Projeto</th>
            <th>Data Início</th>
            <th>Data Fim</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="vinculo : ${projetosVinculados}">
            <td th:text="${vinculo.projetoInterno.nome}"></td>
            <td th:text="${vinculo.dataInicio}"></td>
            <td th:text="${vinculo.dataFim}"></td>
        </tr>
        <tr th:if="${#lists.isEmpty(projetosVinculados)}">
            <td colspan="3" class="text-center">Nenhum projeto vinculado</td>
        </tr>
    </tbody>
</table>

<hr>

<!-- Formulário para vincular novo projeto -->
<h4>Vincular a um Novo Projeto</h4>
<form th:action="@{'/internos/' + ${interno.funcionario.matricula} + '/projetos/vincular'}"
      th:object="${novoVinculo}" method="post">

    <div class="mb-3">
        <label class="form-label">Projeto</label>
        <select class="form-select" th:field="*{idProjeto}">
            <option value="" disabled selected>Selecione um projeto</option>
            <option th:each="p : ${todosProjetos}" th:value="${p.idProjeto}" th:text="${p.nome}"></option>
        </select>
        <div class="text-danger" th:if="${#fields.hasErrors('idProjeto')}" th:errors="*{idProjeto}"></div>
    </div>

    <div class="mb-3">
        <label class="form-label">Data Início</label>
        <input type="date" class="form-control" th:field="*{dataInicio}">
        <div class="text-danger" th:if="${#fields.hasErrors('dataInicio')}" th:errors="*{dataInicio}"></div>
    </div>

    <div class="mb-3">
        <label class="form-label">Data Fim</label>
        <input type="date" class="form-control" th:field="*{dataFim}">
        <div class="text-danger" th:if="${#fields.hasErrors('dataFim')}" th:errors="*{dataFim}"></div>
    </div>

    <button type="submit" class="btn btn-primary">Vincular Projeto</button>
    <a href="/internos" class="btn btn-secondary">Voltar</a>
</form>

</body>
</html>
